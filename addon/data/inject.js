//js from backend to front end

var certManagerJsonText = '{  "Wells Fargo WellsSecure": {    "auditDate": "2014.09.12",     "trustBits": "Websites"  },   "Certificate Issuer Organization": {    "auditDate": "Standard Audit Statement Dt",     "trustBits": "Trust Bits"  },   "The Go Daddy Group, Inc.": {    "auditDate": "2014.08.14",     "trustBits": "Code; Email; Websites"  },   "CNNIC": {    "auditDate": "2014.08.01",     "trustBits": "Websites"  },   "Hellenic Academic and Research Institutions Cert. Authority": {    "auditDate": "2014.12.20",     "trustBits": "Code; Email; Websites"  },   "GlobalSign nv-sa": {    "auditDate": "2014.06.11",     "trustBits": "Code; Email; Websites"  },   "TeliaSonera": {    "auditDate": "2014.07.27",     "trustBits": "Email; Websites"  },   "GoDaddy.com, Inc.": {    "auditDate": "2014.08.14",     "trustBits": "Code; Websites"  },   "DigiCert Inc": {    "auditDate": "2014.07.16",     "trustBits": "Code; Email; Websites"  },   "certSIGN": {    "auditDate": "2015.04.10",     "trustBits": "Code; Email; Websites"  },   "Unizeto Technologies S.A.": {    "auditDate": "2014.07.09",     "trustBits": "Code; Email; Websites"  },   "Equifax Secure Inc.": {    "auditDate": "2014.06.18",     "trustBits": "Email"  },   "Entrust, Inc.": {    "auditDate": "2014.04.21",     "trustBits": "Code; Email; Websites"  },   "GlobalSign": {    "auditDate": "2014.06.11",     "trustBits": "Code; Email; Websites"  },   "IZENPE S.A.": {    "auditDate": "2014.07.31",     "trustBits": "Code; Websites"  },   "SECOM Trust.net": {    "auditDate": "2014.07.31",     "trustBits": "Code; Email; Websites"  },   "NetLock Kft.": {    "auditDate": "2014.06.04",     "trustBits": "Code; Email; Websites"  },   "EBG Bili\u015fim Teknolojileri ve Hizmetleri A.\u015e.": {    "auditDate": "2014.07.30",     "trustBits": "Code; Email; Websites"  },   "SecureTrust Corporation": {    "auditDate": "2014.11.14",     "trustBits": "Code; Websites"  },   "Microsec Ltd.": {    "auditDate": "2015.01.29",     "trustBits": "Code; Email; Websites"  },   "StartCom Ltd.": {    "auditDate": "2015.03.31",     "trustBits": "Code; Email; Websites"  },   "China Financial Certification Authority": {    "auditDate": "2014.12.05",     "trustBits": "Websites"  },   "TC TrustCenter GmbH": {    "auditDate": "2014.02.14",     "trustBits": "All Trust Bits Turned Off"  },   "thawte, Inc.": {    "auditDate": "2014.06.18",     "trustBits": "Code; Websites"  },   "SwissSign AG": {    "auditDate": "2015.04.02",     "trustBits": "Code; Email; Websites"  },   "Entrust.net": {    "auditDate": "2014.04.21",     "trustBits": "Code; Email; Websites"  },   "Equifax": {    "auditDate": "2014.06.18",     "trustBits": "Code; Email; Websites"  },   "T\u00dcRKTRUST Bilgi \u0130leti\u015fim ve Bili\u015fim G\u00fcvenli\u011fi Hizmetleri A.\u015e. (c) Aral\u0131k 2007": {    "auditDate": "2014.12.19",     "trustBits": "Code; Websites"  },   "T\u00fcrkiye Bilimsel ve Teknolojik Ara\u015ft\u0131rma Kurumu - T\u00dcB\u0130TAK": {    "auditDate": "2014.08.26",     "trustBits": "Email; Websites"  },   "Certplus": {    "auditDate": "2015.04.09",     "trustBits": "Email; Websites"  },   "WISeKey": {    "auditDate": "2014.05.27",     "trustBits": "Email; Websites"  },   "(c) 2005 T\u00dcRKTRUST Bilgi \u0130leti\u015fim ve Bili\u015fim G\u00fcvenli\u011fi Hizmetleri A.\u015e.": {    "auditDate": "2014.12.19",     "trustBits": "Code; Email; Websites"  },   "EDICOM": {    "auditDate": "2014.10.13",     "trustBits": "Code; Email; Websites"  },   "Agencia Catalana de Certificacio (NIF Q-0801176-I)": {    "auditDate": "2014.03.10",     "trustBits": "Websites"  },   "China Internet Network Information Center": {    "auditDate": "2014.08.01",     "trustBits": "Websites"  },   "SECOM Trust Systems CO.,LTD.": {    "auditDate": "2014.07.31",     "trustBits": "Code; Email; Websites"  },   "AS Sertifitseerimiskeskus": {    "auditDate": "2015.01.30",     "trustBits": "Code; Websites"  },   "Certinomis": {    "auditDate": "2014.06.30",     "trustBits": "Websites"  },   "Disig a.s.": {    "auditDate": "2014.10.29",     "trustBits": "Code; Email; Websites"  },   "Generalitat Valenciana": {    "auditDate": "2014.07.21",     "trustBits": "Code; Email; Websites"  },   "IdenTrust": {    "auditDate": "2014.07.25",     "trustBits": "Email; Websites"  },   "SG TRUST SERVICES": {    "auditDate": "2014.09.15",     "trustBits": "Email"  },   "E-Tu\u011fra EBG Bili\u015fim Teknolojileri ve Hizmetleri A.\u015e.": {    "auditDate": "2014.07.30",     "trustBits": "Code; Websites"  },   "VeriSign, Inc.": {    "auditDate": "2014.06.18",     "trustBits": "Code; Email; Websites"  },   "Sistema Nacional de Certificacion Electronica": {    "auditDate": "2014.06.20",     "trustBits": "Code; Email; Websites"  },   "Comodo CA Limited": {    "auditDate": "2014.09.10",     "trustBits": "Code; Email; Websites"  },   "Trustis Limited": {    "auditDate": "2015.03.01",     "trustBits": "Email; Websites"  },   "Actalis S.p.A./03358520967": {    "auditDate": "2014.09.23",     "trustBits": "Code; Websites"  },   "Digital Signature Trust Co.": {    "auditDate": "2014.07.25",     "trustBits": "Websites"  },   "Autoridad de Certificacion Firmaprofesional": {    "auditDate": "2015.03.11",     "trustBits": "Code; Email; Websites"  },   "Government Root Certification Authority": {    "auditDate": "2014.04.23",     "trustBits": "Code; Email; Websites"  },   "T-Systems Enterprise Services GmbH": {    "auditDate": "2014.07.11",     "trustBits": "Websites"  },   "Chunghwa Telecom Co., Ltd.": {    "auditDate": "2014.11.26",     "trustBits": "Code; Email; Websites"  },   "Japan Certification Services, Inc.": {    "auditDate": "2014.07.31",     "trustBits": "Websites"  },   "Hongkong Post": {    "auditDate": "2014.02.28",     "trustBits": "Websites"  },   "WoSign CA Limited": {    "auditDate": "2015.02.28",     "trustBits": "Code; Email; Websites"  },   "A-Trust Ges. f. Sicherheitssysteme im elektr. Datenverkehr GmbH": {    "auditDate": "2014.10.03",     "trustBits": "Websites"  },   "D-Trust GmbH": {    "auditDate": "2015.02.27",     "trustBits": "Websites"  },   "Sonera": {    "auditDate": "2014.07.27",     "trustBits": "Email; Websites"  },   "COMODO CA Limited": {    "auditDate": "2014.09.10",     "trustBits": "Code; Email; Websites"  },   "AC Camerfirma S.A.": {    "auditDate": "2014.05.30",     "trustBits": "Code; Email; Websites"  },   "QuoVadis Limited": {    "auditDate": "2015.03.27",     "trustBits": "Code; Email; Websites"  },   "TAIWAN-CA": {    "auditDate": "2014.05.15",     "trustBits": "Code; Email; Websites"  },   "Cybertrust, Inc": {    "auditDate": "2014.12.15",     "trustBits": "Websites"  },   "VISA": {    "auditDate": "2014.06.06",     "trustBits": "Code; Email; Websites"  },   "NetLock Halozatbiztonsagi Kft.": {    "auditDate": "2014.06.04",     "trustBits": "Email"  },   "Unizeto Sp. z o.o.": {    "auditDate": "2014.07.09",     "trustBits": "Code; Email; Websites"  },   "Swisscom": {    "auditDate": "2014.06.18",     "trustBits": "Code; Websites"  },   "Buypass AS-983163327": {    "auditDate": "2015.02.25",     "trustBits": "Websites"  },   "Digital Signature Trust": {    "auditDate": "2014.07.25",     "trustBits": "Websites"  },   "Staat der Nederlanden": {    "auditDate": "2015.03.03",     "trustBits": "Email; Websites"  },   "Dhimyotis": {    "auditDate": "2015.01.15",     "trustBits": "Email; Websites"  },   "ACCV": {    "auditDate": "2014.07.21",     "trustBits": "Code; Email; Websites"  },   "The USERTRUST Network": {    "auditDate": "2014.09.10",     "trustBits": "Code"  },   "Deutscher Sparkassen Verlag GmbH": {    "auditDate": "2014.04.11",     "trustBits": "Email"  },   "Atos": {    "auditDate": "2014.07.29",     "trustBits": "Code; Email; Websites"  },   "Network Solutions L.L.C.": {    "auditDate": "2015.02.24",     "trustBits": "Websites"  },   "Sociedad Cameral de Certificaci\u00f3n Digital - Certic\u00e1mara S.A.": {    "auditDate": "2014.07.14",     "trustBits": "Code; Email"  },   "GeoTrust Inc.": {    "auditDate": "2014.06.18",     "trustBits": "Code; Email; Websites"  },   "T\u00dcRKTRUST Bilgi \u0130leti\u015fim ve Bili\u015fim G\u00fcvenli\u011fi Hizmetleri A.\u015e. (c) Kas\u0131m 2005": {    "auditDate": "2014.12.19",     "trustBits": "Code; Email; Websites"  },   "AC Camerfirma SA CIF A82743287": {    "auditDate": "2014.05.30",     "trustBits": "Code; Email; Websites"  },   "Deutsche Telekom AG": {    "auditDate": "2014.07.11",     "trustBits": "Code; Email; Websites"  },   "Starfield Technologies, Inc.": {    "auditDate": "2014.08.14",     "trustBits": "Code; Websites"  },   "ComSign": {    "auditDate": "2014.09.16",     "trustBits": "Code; Websites"  },   "PM/SGDN": {    "auditDate": "2014.12.15",     "trustBits": "Code; Email; Websites"  },   "RSA Security Inc": {    "auditDate": "2015.02.11",     "trustBits": "Code; Email; Websites"  },   "Baltimore": {    "auditDate": "2014.12.15",     "trustBits": "Email; Websites"  },   "XRamp Security Services Inc": {    "auditDate": "2014.11.14",     "trustBits": "Code; Email; Websites"  },   "AddTrust AB": {    "auditDate": "2014.09.10",     "trustBits": ""  },   "AffirmTrust": {    "auditDate": "2014.06.30",     "trustBits": "Websites"  },   "Japanese Government": {    "auditDate": "2014.12.25",     "trustBits": "Code; Websites"  }}';

var certManagerJson = JSON.parse(certManagerJsonText);

self.port.on("insert_row",function insert_row(num, source, name, trust, last, country, trustbits){
		var parent = '<tr class="parent" id="row$Num"><td>$Source</td> <td id="name$Num" colspan="2">$Name</td> <td>$Trust</td></tr>';
        parent = parent.replace('$Source', source);
        parent = parent.replace('$Name', name);
        parent = parent.replace('$Trust', trust);
        parent = parent.replace(/\$Num/g, num)

        var sub1 = '<tr class="child-row$Num"><td>&nbsp;</td><td>Last Audit: </td><td>$Last</td></tr>';
        sub1 = sub1.replace('$Num', num)
        sub1 = sub1.replace('$Last', last)

        var sub2 = "<tr class='child-row$Num'><td>&nbsp;</td><td>Country: </td><td>$Country</td></tr>"
        sub2 = sub2.replace('$Num', num)
        sub2 = sub2.replace('$Country', country)

        var sub3 = "<tr class='child-row$Num'><td>&nbsp;</td><td>TrustBits: </td><td>$TrustBits</td></tr>"
        sub3 = sub3.replace('$Num', num)
        sub3 = sub3.replace('$TrustBits', trustbits)

        var sub4 = "<tr class='child-row$Num'><td>&nbsp;</td><td>&nbsp;</td><td><button onclick='showDetails($Num);' class='moreButton'>View Certificates</button></td></tr>"
        sub4 = sub4.replace(/\$Num/g, num)

        var table = document.getElementById("auth_table");
        table.innerHTML += parent;
        table.innerHTML += sub1;
        table.innerHTML += sub2;
        table.innerHTML += sub3;
        table.innerHTML += sub4;
        
        $('tr.parent')
        .css("cursor","pointer")
        .attr("title","Click to expand Certificate")
        .click(function(){
            $(this).siblings('.child-'+this.id).toggle();
        });

        $('#row$Num'.replace('$Num', num)).click();
    }
);

// web, email, and software should be either "" or "checked"
self.port.on("insert_cert", function insert_cert(num, name, builtin, web, email, software){
    var parent = '<tr class="parent" id="row$Num"><td>$Name</td> <td>$Builtin</td> <td><input type="checkbox" $Web></input></td> <td><input type="checkbox" $Email></input></td> <td><input type="checkbox" $Software></input></td></tr>';
    parent = parent.replace(/\$Num/g, num);
    parent = parent.replace(/\$Name/g, name);
    parent = parent.replace(/\$Builtin/g, builtin);
    parent = parent.replace(/\$Web/g, web);
    parent = parent.replace(/\$Email/g, email);
    parent = parent.replace(/\$Software/g, software);

    var table = document.getElementById("cert_table");
    table.innerHTML += parent;
});